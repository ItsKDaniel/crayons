var __awaiter=this&&this.__awaiter||function(e,t,i,n){function s(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(t){o(t)}}function r(e){try{l(n["throw"](e))}catch(t){o(t)}}function l(e){e.done?i(e.value):s(e.value).then(a,r)}l((n=n.apply(e,t||[])).next())}))};var __generator=this&&this.__generator||function(e,t){var i={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,s,o,a;return a={next:r(0),throw:r(1),return:r(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function r(e){return function(t){return l([e,t])}}function l(a){if(n)throw new TypeError("Generator is already executing.");while(i)try{if(n=1,s&&(o=a[0]&2?s["return"]:a[0]?s["throw"]||((o=s["return"])&&o.call(s),0):s.next)&&!(o=o.call(s,a[1])).done)return o;if(s=0,o)a=[a[0]&2,o.value];switch(a[0]){case 0:case 1:o=a;break;case 4:i.label++;return{value:a[1],done:false};case 5:i.label++;s=a[1];a=[0];continue;case 7:a=i.ops.pop();i.trys.pop();continue;default:if(!(o=i.trys,o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){i=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(a[0]===6&&i.label<o[1]){i.label=o[1];o=a;break}if(o&&i.label<o[2]){i.label=o[2];i.ops.push(a);break}if(o[2])i.ops.pop();i.trys.pop();continue}a=t.call(e,i)}catch(r){a=[6,r];s=0}finally{n=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};var __spreadArray=this&&this.__spreadArray||function(e,t){for(var i=0,n=t.length,s=e.length;i<n;i++,s++)e[s]=t[i];return e};System.register(["./index-c04bc24f.system.js","./lodash-98c269d2.system.js","./Translation-8bb6d271.system.js","./index-beb9b2be.system.js"],(function(e){"use strict";var t,i,n,s,o,a,r,l,u,c,d;return{setters:[function(e){t=e.r;i=e.h;n=e.i;s=e.F;o=e.j},function(e){a=e.u;r=e.r},function(e){l=e.T},function(e){u=e.v;c=e.r;d=e.h}],execute:function(){var p=':host{font-family:var(--fw-font-family, -apple-system, BlinkMacSystemFont, "Segoe UI", roboto, oxygen, ubuntu, cantarell, "Open Sans", "Helvetica Neue", sans-serif);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-box-sizing:border-box;box-sizing:border-box}:host{display:block;min-width:0}.email-select-container{min-width:0;margin:1px}.input-container{min-width:0;width:calc(100% - 10px);border-radius:var(--fw-select-border-radius, 4px);-webkit-padding-start:10px;padding-inline-start:10px;background-color:#fff;-webkit-box-shadow:none;box-shadow:none;min-height:22px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;margin:1px;}.input-container .input-container-inner{min-width:0;display:-ms-flexbox;display:flex;-ms-flex-positive:1;flex-grow:1;-ms-flex-wrap:wrap;flex-wrap:wrap}.input-container .input-container-inner .tag-container{min-width:0;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;}.input-container .input-container-inner .tag-container:focus,.input-container .input-container-inner .tag-container:focus-visible{outline:none}.input-container .input-container-inner .tag-container fw-tag{display:-ms-flexbox;display:flex;min-width:0;margin:4px;-webkit-touch-callout:none;font-weight:600;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.input-container .input-container-inner input{-ms-flex-positive:1;flex-grow:1;border:none;font-family:inherit;font-size:14px;font-weight:500;letter-spacing:0;line-height:1.4;background-color:#fff;min-width:20px;min-height:22px;-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden;margin-inline:0px;margin-block:4px}.input-container .input-container-inner input:focus{border:none;outline:none}.input-container .input-container-inner input.multi-select{width:auto}.input-container .input-container-inner input:disabled{background-color:#f5f7f9 !important;border-color:transparent;cursor:not-allowed}.input-container fw-spinner{-webkit-margin-end:8px;margin-inline-end:8px}@media (prefers-reduced-motion){.input-container:hover,.input-container:focus{-webkit-transition:none;transition:none}}.input-container:hover,.input-container:focus{-webkit-transition:0.2s linear;transition:0.2s linear}.input-container.select-disabled{color:#ebeff3;background-color:#f5f7f9 !important;border-style:solid;cursor:not-allowed}.input-container.select-disabled:hover{border:1px solid #cfd7df}.has-focus .input-container{outline:none;background:#fff;-webkit-box-shadow:0 0 0 2px #2c5cc5;box-shadow:0 0 0 2px #2c5cc5}.select-container{-webkit-margin-after:var(--fw-select-margin-bottom, 0px);margin-block-end:var(--fw-select-margin-bottom, 0px);width:inherit;height:inherit;position:relative}.select-container .to-container{-webkit-padding-end:20px;padding-inline-end:20px}.select-container .dropdown{z-index:99}.select-container .dropdown-status-icon{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;-webkit-margin-end:8px;margin-inline-end:8px;min-width:20px;min-height:20px;-webkit-transition:all 0.15s;transition:all 0.15s;--icon-color:$color-elephant-800}:host(:not([dir="rtl"])) .select-container .dropdown-status-icon.expanded,:host([dir="ltr"]) .select-container .dropdown-status-icon.expanded{-webkit-transform:rotate(180deg);transform:rotate(180deg)}:host([dir="rtl"]) .select-container .dropdown-status-icon.expanded{-webkit-transform:rotate(-180deg);transform:rotate(-180deg)}::-webkit-input-placeholder{color:#92a2b1;opacity:1}::-moz-placeholder{color:#92a2b1;opacity:1}:-ms-input-placeholder{color:#92a2b1;opacity:1}::-ms-input-placeholder{color:#92a2b1;opacity:1}::placeholder{color:#92a2b1;opacity:1}:-ms-input-placeholder{color:#92a2b1}::-ms-input-placeholder{color:#92a2b1}.tag-container .tag-default{cursor:pointer}.tag-container .tag-disabled{cursor:not-allowed}.single-select-value{font-size:14px;font-weight:400;-webkit-padding-start:8px;padding-inline-start:8px;color:#12344d}.ellipsis{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.single-value-tag{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;min-width:0}:host(:not([dir="rtl"])) .single-value-tag,:host([dir="ltr"]) .single-value-tag{margin:4px 4px 4px 6px}:host([dir="rtl"]) .single-value-tag{margin:4px 6px 4px 4px}.readonly{-webkit-margin-start:20px !important;margin-inline-start:20px !important}.single-value-button{display:-ms-flexbox;display:flex}';var h=e("fw_email_select",function(){function e(e){var n=this;t(this,e);this.fwChange=i(this,"fwChange",7);this.fwFocus=i(this,"fwFocus",7);this.fwBlur=i(this,"fwBlur",7);this.tagArrowKeyCounter=0;this.changeEmittable=function(){return!n.disabled};this.innerOnFocus=function(e){if(n.changeEmittable()){n.hasFocus=true;n.fwFocus.emit(e);n.focusedValues=[]}};this.innerOnClick=function(){var e,t;n.setFocus();n.multiple||((t=(e=n.selectInput)===null||e===void 0?void 0:e.select)===null||t===void 0?void 0:t.call(e));if(!n.multiple){n.openDropdown()}n.focusedValues=[]};this.innerOnBlur=function(e){if(n.changeEmittable()){n.hasFocus=false;n.fwBlur.emit({event:e,name:n.name})}};this.openDropdown=function(){if(!n.isExpanded&&n.changeEmittable()){n.popover.show()}};this.closeDropdown=function(){if(n.isExpanded&&n.changeEmittable()){n.popover.hide()}};this.isExpanded=false;this.hasFocus=false;this.selectedOptionsState=[];this.isLoading=false;this.focusedOptionId="";this.focusedValues=[];this.addTooltip=false;this.name="";this.readonly=false;this.multiple=false;this.max=Number.MAX_VALUE;this.selectedOptions=[];this.allowDeselect=false;this.disabled=false;this.debounceTimer=300;this.maxEmailsAllowed=50;this.tagContainerKeyDown=function(e){var t;switch(e.key){case"Escape":n.innerOnBlur(e);n.closeDropdown();break;case"Delete":case"Backspace":if(n.focusedValues.length>0){n.setSelectedOptions(n.selectedOptionsState.filter((function(e,t){return!n.focusedValues.includes(t)})));n.focusedValues=[]}break;case"ArrowLeft":if(n.tagArrowKeyCounter-1>=0){if(!n.selectedOptionsState[n.tagArrowKeyCounter-1].disabled){n.tagArrowKeyCounter--;n.focusOnTag(n.tagArrowKeyCounter)}}else{n.tagArrowKeyCounter=0}e.stopImmediatePropagation();break;case"ArrowRight":n.tagArrowKeyCounter++;if(n.tagArrowKeyCounter>=n.value.length){(t=n.selectInput)===null||t===void 0?void 0:t.focus()}else{n.focusOnTag(n.tagArrowKeyCounter)}e.stopImmediatePropagation();break}};this.componentDidRender=function(){var e=n.singleValueLabel;if(e&&!n.resizeObserver){n.resizeObserver=new ResizeObserver((function(){if(e.offsetWidth>0){n.addTooltip=e.offsetWidth<e.scrollWidth?true:false}}));n.resizeObserver.observe(e)}};this.removeResizeObserver=function(){if(n.resizeObserver){n.resizeObserver.disconnect();n.resizeObserver=null}}}e.prototype.onDropdownClose=function(e){var t;if(e.composedPath()[0].id==="list-items-popover"){this.clearInput();this.isExpanded=false;this.multiple&&((t=this.selectInput)===null||t===void 0?void 0:t.focus())}};e.prototype.onDropdownOpen=function(e){if(e.composedPath()[0].id==="list-items-popover"){this.isExpanded=true}};e.prototype.onLoading=function(e){this.isLoading=e.detail.isLoading;if(this.multiple&&!this.isLoading&&!this.readonly){this.selectInput.value.trim()&&this.openDropdown()}};e.prototype.fwSelectedHandler=function(e){var t,i,n;if(e.composedPath()[0].tagName==="FW-LIST-OPTIONS"){this.selectedOptionsState=(i=(t=e.detail)===null||t===void 0?void 0:t.meta)===null||i===void 0?void 0:i.selectedOptions;this.value=e.detail.value;this.renderInput();this.closeDropdown();e.stopImmediatePropagation();e.stopPropagation();e.preventDefault();if(this.selectedOptionsState.length>0){this.fwChange.emit({name:this.name,value:this.value,meta:{selectedOptions:this.selectedOptionsState}})}else{this.fwChange.emit({name:this.name,value:this.value,meta:{shouldValidate:false,selectedOptions:this.selectedOptionsState}})}if(this.multiple){(n=this.selectInput)===null||n===void 0?void 0:n.focus()}}};e.prototype.fwCloseHandler=function(e){this.setSelectedOptions(this.selectedOptionsState.filter((function(t,i){return i!==e.detail.index})));this.focusOnTagContainer()};e.prototype.onKeyDown=function(e){var t=this;var i;switch(e.key){case"ArrowDown":this.innerOnClick();this.fwListOptions.setFocus();e.preventDefault();e.stopPropagation();break;case"Delete":case"Backspace":if(this.focusedValues.length>0){this.setSelectedOptions(this.selectedOptionsState.filter((function(e,i){return!t.focusedValues.includes(i)})));this.focusedValues=[]}break;case"ArrowLeft":if(this.multiple&&this.selectInput.value===""){this.focusOnTagContainer()}break;case"Escape":this.innerOnBlur(e);this.closeDropdown();break;case"Tab":this.focusedValues=[];this.closeDropdown();break;case"a":case"A":if((e.ctrlKey||e.metaKey)&&!this.searchValue||this.focusedValues.length>0){(i=this.tagContainer)===null||i===void 0?void 0:i.focus();this.focusedValues=this.selectedOptionsState.reduce((function(e,t,i){return!t.disabled&&e.push(i),e}),[])}break}};e.prototype.onOptionFocus=function(e){if(e.composedPath()[0].tagName==="FW-SELECT-OPTION"){this.focusedOptionId=e.detail.id}};e.prototype.onOptionBlur=function(e){if(e.composedPath()[0].tagName==="FW-SELECT-OPTION"){this.focusedOptionId=""}};e.prototype.optionsChangedHandler=function(){this.renderInput()};e.prototype.onOptionsChange=function(e){var t=this;var i;var n=e===null||e===void 0?void 0:e.filter((function(e){return e.selected}));if(n.length>0){this.dataSource=e;this.selectedOptionsState=n;this.value=this.multiple?this.selectedOptionsState.map((function(e){return e.value})):(i=this.selectedOptionsState[0])===null||i===void 0?void 0:i.value}else if(this.valueExists()){this.dataSource=e.map((function(e){return Object.assign(Object.assign({},e),{selected:t.isValueEqual(t.value,e)})}))}else{this.dataSource=e;this.value=this.multiple?[]:"";this.selectedOptionsState=[]}};e.prototype.onSelectedOptionsChange=function(e){this.setSelectedOptions(e)};e.prototype.getSelectedItem=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){return[2,this.fwListOptions.getSelectedOptions()]}))}))};e.prototype.setSelectedValues=function(e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){this.fwListOptions.setSelectedValues(e);this.renderInput();return[2]}))}))};e.prototype.setSelectedOptions=function(e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){this.fwListOptions.setSelectedOptions(e);this.renderInput();return[2]}))}))};e.prototype.setFocus=function(){return __awaiter(this,void 0,void 0,(function(){var e;return __generator(this,(function(t){this.hasFocus=true;(e=this.selectInput)===null||e===void 0?void 0:e.focus();return[2]}))}))};e.prototype.focusOnTagContainer=function(){if(this.tagContainer){if(!this.selectedOptionsState[this.value.length-1].disabled){this.tagArrowKeyCounter=this.value.length-1;this.focusOnTag(this.tagArrowKeyCounter)}}};e.prototype.focusOnTag=function(e){if(!this.selectedOptionsState[e].disabled){this.focusedValues=[e];this.tagContainer.focus()}};e.prototype.clearInput=function(){if(!this.multiple&&this.value){this.renderInput();return}this.searchValue="";if(this.selectInput){this.selectInput.value=""}};e.prototype.isValueEqual=function(e,t){return this.multiple?e.includes(t.value):e===t.value};e.prototype.valueExists=function(){return this.value&&(this.multiple?this.value.length>0:!!this.value)};e.prototype.onInput=function(){this.searchValue=this.selectInput.value;if(this.selectInput.value.trim()){!this.multiple&&this.openDropdown()}else{this.multiple||this.setSelectedValues("");this.closeDropdown()}this.focusedValues=[]};e.prototype.onClickTag=function(e,t){e.stopPropagation();this.tagContainer.focus();if(!this.selectedOptionsState[t].disabled){var i=this.focusedValues.indexOf(t);if(i===-1){if(e.ctrlKey||e.metaKey){this.focusedValues=__spreadArray(__spreadArray([],this.focusedValues),[t])}else if(e.shiftKey&&this.focusedValues.length>0){var n=this.focusedValues[this.focusedValues.length-1];var s=t>n?t+1:t-1;this.focusedValues=a(__spreadArray(__spreadArray([],this.focusedValues),r(n,s<0?0:s)))}else{this.focusedValues=[t]}}else if(e.ctrlKey||e.metaKey){this.focusedValues=this.focusedValues.filter((function(e,t){return t!==i}))}else if(!e.shiftKey){this.focusedValues=[t]}}};e.prototype.renderTags=function(){var e=this;if(this.multiple&&Array.isArray(this.value)){return this.selectedOptionsState.map((function(t,i){if(e.isValueEqual(e.value,t)){var s=t.error||i>=e.maxEmailsAllowed?"error":"normal";return n("fw-tag",{index:i,isFocused:e.focusedValues.includes(i),class:t.disabled?"tag-disabled":"tag-default",state:s,variant:"avatar",graphicsProps:t.graphicsProps,text:t.value,disabled:t.disabled,value:t.value,focusable:false,closable:!t.disabled,onClick:function(t){return e.onClickTag(t,i)},showEllipsisOnOverflow:true})}}))}};e.prototype.renderInput=function(){if(this.selectedOptionsState.length>0){if(this.selectInput){this.selectInput.value="";this.selectInput.value=this.multiple?this.selectInput.value:this.selectedOptionsState[0].text||""}}else{if(this.selectInput){this.selectInput.value=""}}};e.prototype.renderLabel=function(e){return n("span",{class:"single-select-value"},e===null||e===void 0?void 0:e.text," <",e===null||e===void 0?void 0:e.subText,">")};e.prototype.renderSingleValue=function(e){var t=this;var i;if(e){return n("span",{class:"single-value-tag "+(this.readonly?"readonly":"")},n("fw-avatar",{size:"xsmall",image:(i=e===null||e===void 0?void 0:e.graphicsProps)===null||i===void 0?void 0:i.image}),n("div",{class:"ellipsis",ref:function(e){return t.singleValueLabel=e}},this.addTooltip?n("fw-tooltip",{trigger:"hover",content:(e===null||e===void 0?void 0:e.text)+" <"+(e===null||e===void 0?void 0:e.subText)+">"},this.renderLabel(e)):this.renderLabel(e)))}};e.prototype.onClickOutside=function(e){if(!e.composedPath().includes(this.host)&&this.focusedValues.length>0){this.focusedValues=[]}};e.prototype.componentWillLoad=function(){var e=this;var t,i;var n=Array.from(this.host.querySelectorAll("fw-select-option"));if(this.selectedOptions.length>0){this.selectedOptionsState=this.selectedOptions;this.value=this.multiple?this.selectedOptions.map((function(e){return e.value})):this.selectedOptions[0].value}if(this.multiple){if(this.multiple&&typeof this.value==="string"){throw Error("value must be a array of string when multiple is true")}this.value=((t=this.value)===null||t===void 0?void 0:t.length)>0?this.value:[]}else{this.value=this.value?this.value:""}var s=n.map((function(t){return{html:t.html,text:t.html?t.optionText:t.textContent,value:t.value,selected:e.isValueEqual(e.value,t)||t.selected,disabled:t.disabled,htmlContent:t.html?t.innerHTML:""}}));this.dataSource=s.length===0?this.options:s;if(!this.multiple&&this.value&&this.selectedOptions.length===0){this.selectedOptionsState=this.dataSource.filter((function(t){return e.value===t.value}))}else if(this.multiple&&this.value.length!==this.selectedOptions.length){this.selectedOptionsState=this.dataSource.filter((function(t){return e.isValueEqual(e.value,t)}))}if(((i=this.dataSource)===null||i===void 0?void 0:i.length)>0){var o=this.dataSource.filter((function(e){return e.selected}));var a=o.map((function(e){return e.value}));var r=this.multiple?a:a[0];if(a.length>0&&JSON.stringify(this.value)!==JSON.stringify(r)){this.value=r;this.selectedOptionsState=o}}this.host.addEventListener("focus",this.setFocus);this.hostId=this.host.id||"";document.addEventListener("mouseup",this.onClickOutside.bind(this))};e.prototype.componentDidLoad=function(){this.renderInput()};e.prototype.disconnectedCallback=function(){this.host.removeEventListener("focus",this.setFocus);document.removeEventListener("mouseup",this.onClickOutside.bind(this));this.removeResizeObserver()};e.prototype.expandWatcher=function(e){var t,i,n,s;if(!this.multiple){var o=(s=(n=(i=(t=this.host.shadowRoot)===null||t===void 0?void 0:t.querySelector(".select-container"))===null||i===void 0?void 0:i.querySelector("fw-button"))===null||n===void 0?void 0:n.shadowRoot)===null||s===void 0?void 0:s.querySelector("fw-icon");o&&(o.name=e?"chevron-up":"chevron-down")}};e.prototype.onPaste=function(e){var t=(e===null||e===void 0?void 0:e.clipboardData)||window["clipboardData"];var i=t===null||t===void 0?void 0:t.getData("Text");if(i.includes("\n")||i.includes(",")){e.stopPropagation();e.preventDefault();var n=i.split(/[\n,]/);var s=[];n.forEach((function(e){var t=e.trim();if(t){s.push({text:t,value:t,error:!u(t)})}}));if(s.length>0){this.setSelectedOptions(__spreadArray(__spreadArray([],this.selectedOptionsState),s))}}};e.prototype.render=function(){var e=this;var t=this,i=t.host,o=t.name,a=t.value;c(i,o,a);return n("div",{"aria-disabled":this.disabled,class:{"email-select-container":true,"has-focus":this.hasFocus}},n("div",{class:{"select-container":true},role:"combobox","aria-controls":this.hostId+"-listbox","aria-haspopup":"listbox","aria-expanded":this.isExpanded,"aria-owns":this.hostId+"-listbox"},n("fw-popover",{id:"list-items-popover",distance:"8",trigger:"manual",ref:function(t){return e.popover=t},placement:"bottom",boundary:this.host.parentElement,hoist:true},n("div",{slot:"popover-trigger",class:{"input-container":this.multiple&&!this.readonly,"select-disabled":this.disabled},onClick:function(){return!e.readonly&&e.innerOnClick()},onKeyDown:d(this.innerOnClick,true),role:"button",tabIndex:-1},this.readonly?this.renderSingleValue(this.selectedOptionsState[0]):!this.multiple?n("fw-button",{class:"single-value-button",color:"text",disabled:this.disabled,"show-caret-icon":true},this.renderSingleValue(this.selectedOptionsState[0])):n(s,null,n("div",{class:"input-container-inner"},this.multiple&&n("div",{class:"tag-container",onFocus:this.focusOnTagContainer,ref:function(t){return e.tagContainer=t},onKeyDown:this.tagContainerKeyDown,role:"listbox","aria-multiselectable":"true",tabIndex:-1},this.renderTags()),n("input",{ref:function(t){return e.selectInput=t},class:{"multiple-select":this.multiple},autoComplete:"off",disabled:this.disabled,name:this.name,id:this.name,placeholder:this.valueExists()?"":this.placeholder||"",readOnly:this.readonly,value:"","aria-autocomplete":"list","aria-activedescendant":this.focusedOptionId,onInput:function(){return e.onInput()},onFocus:function(t){return e.innerOnFocus(t)},onBlur:function(t){return e.innerOnBlur(t)},"aria-describedby":"hint-"+this.name+" error-"+this.name,onPaste:function(t){return e.onPaste(t)}})),this.isLoading&&n("fw-spinner",{size:"small"}))),n("fw-list-options",{ref:function(t){return e.fwListOptions=t},id:this.hostId+"-listbox",role:"listbox","aria-labelledby":this.hostId+"-label",debounceTimer:this.debounceTimer,search:this.search,selectedOptions:this.selectedOptions,variant:"avatar","filter-text":this.searchValue,options:this.dataSource,value:this.value,multiple:this.multiple,max:this.max,disabled:this.disabled,allowDeselect:this.allowDeselect,slot:"popover-content",validateNewOption:function(e){return!u(e)},formatCreateLabel:function(e){return l.t("emailSelect.createLabel",{label:e})},isCreatable:true}))))};Object.defineProperty(e.prototype,"host",{get:function(){return o(this)},enumerable:false,configurable:true});Object.defineProperty(e,"watchers",{get:function(){return{dataSource:["optionsChangedHandler"],options:["onOptionsChange"],selectedOptions:["onSelectedOptionsChange"],isExpanded:["expandWatcher"]}},enumerable:false,configurable:true});return e}());h.style=p}}}));